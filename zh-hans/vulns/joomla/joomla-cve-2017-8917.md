# 💛 Joomla3.7 Core com_fields组件SQL注入

### 1）漏洞信息

|漏洞名称	|受影响组件	|漏洞类型	|漏洞编号	|
|--	|--	|--	|--	|
|Joomla3.7 Core com_fields组件SQL注入	|[Joomla](https://downloads.joomla.org/zh-cn/)	|SQL注入	|CVE-2017-8917	|

|漏洞简介	|
|--	|
|本漏洞出现在3.7.0新引入的一个组件“com_fields”，这个组件任何人都可以访问，无需登陆验证。由于对请求数据过滤不严导致SQL注入。	|

|参考链接	|
|--	|
|<ol><li><a href="https://vulhub.org/#/environments/joomla/CVE-2017-8917/">https://vulhub.org/#/environments/joomla/CVE-2017-8917/</a></li><li><a href="https://blog.csdn.net/BROTHERYY/article/details/109155428">https://blog.csdn.net/BROTHERYY/article/details/109155428</a></li></ol>	|

|补丁及修复方案	|
|--	|
|升级至最新版本<ol><li><a href="https://downloads.joomla.org/zh-cn/">https://downloads.joomla.org/zh-cn/</a></li></ol>	|

### 漏洞环境

* 使用[vulhub](https://github.com/vulhub/vulhub)搭建漏洞环境

```
git clone https://github.com/vulhub/vulhub
cd vulhub/joomla/CVE-2017-8917
docker-compose up -d
```

访问8080端口即可看到Joomla安装页面
* 填写相关信息（随意填）
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/joomla/cve-2017-8917/02.png" alt=""><figcaption></figcaption></figure>

填写数据库信息
* 数据库地址：mysql:3306
* 用户：root
* 密码：root
* 数据库名：joomla

<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/joomla/cve-2017-8917/03.png" alt=""><figcaption></figcaption></figure>

安装之后，点击“<b>删除installation目录</b>”
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/joomla/cve-2017-8917/04.png" alt=""><figcaption></figcaption></figure>

删除installation目录之后，回到前台即可看到Joomla页面
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/joomla/cve-2017-8917/05.png" alt=""><figcaption></figcaption></figure>


### 漏洞复现

```
python3 vulcat.py -u <URL> -a joomla -v cve-2017-8917

# 注意, vulcat-v2.0.0版本及以上, 应使用以下命令
python3 vulcat.py -u <URL> -v cve-2017-8917
```

<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/joomla/cve-2017-8917/06.png" alt=""><figcaption></figcaption></figure>


直接访问Target，可以在页面上看到一串md5值
* 通过在线工具解密md5值
* 解密后的值2257与Payload中的一致
* 说明存在SQL注入漏洞
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/joomla/cve-2017-8917/07.png" alt=""><figcaption></figcaption></figure>


将md5()替换为user()
* 在页面上可以看到用户信息“root@172.28.0.3”
<figure><img src="https://cdn.staticaly.com/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/joomla/cve-2017-8917/08.png" alt=""><figcaption></figcaption></figure>
