(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{427:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"持久卷-pv-常用-yaml-配置项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#持久卷-pv-常用-yaml-配置项"}},[s._v("#")]),s._v(" 持久卷（PV）常用 yaml 配置项")]),s._v(" "),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("学习更多")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档-持久卷"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"一个简单的pv"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一个简单的pv"}},[s._v("#")]),s._v(" "),a("Badge",{attrs:{type:"error",text:"1"}}),s._v("一个简单的PV")],1),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" PersistentVolume\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pv01\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("storageClassName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" k8s\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumeMode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Filesystem\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("accessModes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ReadWriteOnce\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("capacity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("storage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 5Gi\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("persistentVolumeReclaimPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Recycle\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nfs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 192.168.1.1\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("path")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" /nfsdata\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h3",{attrs:{id:"spec-storageclassname"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spec-storageclassname"}},[s._v("#")]),s._v(" "),a("Badge",{attrs:{type:"error",text:"spec"}}),s._v("spec.storageClassName")],1),s._v(" "),a("p",[s._v("存储类名。")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("storageClassName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" <名称"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"spec-volumemode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spec-volumemode"}},[s._v("#")]),s._v(" "),a("Badge",{attrs:{type:"error",text:"spec"}}),s._v("spec.volumeMode")],1),s._v(" "),a("p",[s._v("PV 存储模式：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("Filesystem")]),s._v("：可以被挂载到主机的文件系统中。")])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("volumeMode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Filesystem\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"spec-accessmodes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spec-accessmodes"}},[s._v("#")]),s._v(" "),a("Badge",{attrs:{type:"error",text:"spec"}}),s._v("spec.accessModes")],1),s._v(" "),a("p",[s._v("PV 访问模式：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("ReadWriteOnce")]),s._v("（RWO），仅允许"),a("b",[s._v("单个")]),s._v("节点挂载读写")]),s._v(" "),a("li",[a("code",[s._v("ReadWriteMany")]),s._v("（RWX），允许多个节点挂载读写")]),s._v(" "),a("li",[a("code",[s._v("ReadOnlyMany")]),s._v("（ROX），允许多个节点挂载"),a("b",[s._v("只读")])])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("accessModes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" ReadWriteOnce\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"spec-capacity"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spec-capacity"}},[s._v("#")]),s._v(" "),a("Badge",{attrs:{type:"error",text:"spec"}}),s._v("spec.capacity")],1),s._v(" "),a("p",[s._v("PV 存储上限。")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 存储上限为 5GiB，这个计量单位和 “容器资源限制” 中介绍的一样")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("capacity")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("storage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 5Gi\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"spec-persistentvolumereclaimpolicy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spec-persistentvolumereclaimpolicy"}},[s._v("#")]),s._v(" "),a("Badge",{attrs:{type:"error",text:"spec"}}),s._v("spec.persistentVolumeReclaimPolicy")],1),s._v(" "),a("p",[s._v("回收策略：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("Recycle")]),s._v("（回收）：当 PVC 被删除之后，PV 里的数据也会被清空（包括存储服务器上的），然后 PV 变为空闲状态，可以被其他的 PVC 绑定")]),s._v(" "),a("li",[a("code",[s._v("Retain")]),s._v("（保留）：当 PVC 被删除之后，PV 变为不可用状态，等待用户手动清理数据；然后必须手动删除并重新创建 PV，才能被其他 PVC 绑定")]),s._v(" "),a("li",[a("code",[s._v("Delete")]),s._v("（删除）：当 PV 被删除之后，所关联的存储数据会被一并删除。")])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("persistentVolumeReclaimPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Recycle\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"custom-block note"},[a("p",{staticClass:"custom-block-title"},[s._v("笔记")]),s._v(" "),a("p",[s._v("截至 k8s v1.28 版本，仅 NFS 和 HostPath 支持回收（"),a("code",[s._v("Recycle")]),s._v("）。 AWS EBS 和 GCE PD 卷支持删除（"),a("code",[s._v("Delete")]),s._v("）。")])]),s._v(" "),a("div",{staticClass:"custom-block danger"},[a("p",{staticClass:"custom-block-title"},[s._v("警告")]),s._v(" "),a("p",[s._v("回收策略"),a("code",[s._v("Recycle")]),s._v("已被废弃。取而代之的建议方案是使用动态制备。")])])])}),[],!1,null,null,null);a.default=n.exports}}]);