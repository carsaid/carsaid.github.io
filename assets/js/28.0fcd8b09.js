(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{340:function(s,a,t){"use strict";t.r(a);var e=t(7),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"课后练习题-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#课后练习题-3"}},[s._v("#")]),s._v(" 课后练习题-3")]),s._v(" "),a("h2",{attrs:{id:"理论练习-开放性试题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#理论练习-开放性试题"}},[s._v("#")]),s._v(" 理论练习（开放性试题）")]),s._v(" "),a("p",[s._v("涵盖第 5 章的内容。")]),s._v(" "),a("ol",[a("li",[s._v("master 节点上静态 Pod 的 yaml 文件默认存储在哪个目录下？")]),s._v(" "),a("li",[s._v("修改静态 Pod 存储路径的方式有两种，是哪两种？")])]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("答案")]),s._v(" "),a("ol",[a("li",[s._v("master 静态 Pod 的 yaml 文件默认存储于"),a("code",[s._v("/etc/kubernetes/manifests/")]),s._v("目录下。")]),s._v(" "),a("li",[s._v("修改静态 Pod 路径：")])]),s._v(" "),a("ul",[a("li",[s._v("第一种——修改 kubelet 服务文件"),a("code",[s._v("/usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf")]),s._v("，在选项"),a("code",[s._v('Environment="..."')]),s._v("后面添加参数"),a("code",[s._v("--pod-manifest-path=<目录>")]),s._v("。")]),s._v(" "),a("li",[s._v("第二种——修改 k8s 配置文件"),a("code",[s._v("/var/lib/kubelet/config.yaml")]),s._v("，重新配置参数"),a("code",[s._v("staticPodPath: <目录>")]),s._v("。")])])]),s._v(" "),a("h2",{attrs:{id:"实操练习"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实操练习"}},[s._v("#")]),s._v(" 实操练习")]),s._v(" "),a("p",[s._v("涵盖第 5 的内容。")]),s._v(" "),a("ol",[a("li",[s._v("列出命名空间"),a("code",[s._v("kube-system")]),s._v("中的 Pod，并查看这些 Pod 是运行在哪些节点上的")]),s._v(" "),a("li",[s._v("列出所有 Pod 的负载信息，并按照内存使用率进行排序")]),s._v(" "),a("li",[s._v("计算所有命名空间中一共有多少个 Pod")]),s._v(" "),a("li",[s._v("创建命名空间"),a("code",[s._v("ns1")])]),s._v(" "),a("li",[s._v("通过命令行创建一个 Pod，要求如下：")])]),s._v(" "),a("ul",[a("li",[s._v("名称为"),a("code",[s._v("pod1")])]),s._v(" "),a("li",[s._v("容器镜像为"),a("code",[s._v("nginx")])]),s._v(" "),a("li",[s._v("镜像下载策略为"),a("code",[s._v("IfNotPresent")])]),s._v(" "),a("li",[s._v("设置标签"),a("code",[s._v("run=dynamic")])])]),s._v(" "),a("ol",{attrs:{start:"6"}},[a("li",[s._v("创建包含两个容器的 Pod，要求如下：")])]),s._v(" "),a("ul",[a("li",[s._v("名称为"),a("code",[s._v("pod2")])]),s._v(" "),a("li",[s._v("设置标签"),a("code",[s._v("run=dynamic")])]),s._v(" "),a("li",[s._v("第一个容器名称为"),a("code",[s._v("c1")]),s._v("，镜像为"),a("code",[s._v("nginx")])]),s._v(" "),a("li",[s._v("第二个容器名称为"),a("code",[s._v("c2")]),s._v("，镜像为"),a("code",[s._v("alpine")]),s._v("，创建该容器时运行命令"),a("code",[s._v('echo "hello alpine" && sleep 999999')])]),s._v(" "),a("li",[s._v("容器的镜像下载策略都为"),a("code",[s._v("IfNotPresent")])])]),s._v(" "),a("ol",{attrs:{start:"7"}},[a("li",[s._v("将"),a("code",[s._v("pod1")]),s._v("的"),a("code",[s._v("/etc/hosts")]),s._v("文件拷贝到物理机的当前目录中")]),s._v(" "),a("li",[s._v("查看"),a("code",[s._v("pod2")]),s._v("容器"),a("code",[s._v("c2")]),s._v("的日志信息")]),s._v(" "),a("li",[s._v("在"),a("code",[s._v("pod2")]),s._v("容器"),a("code",[s._v("c2")]),s._v("中执行命令"),a("code",[s._v("ifconfig")])]),s._v(" "),a("li",[s._v("切换至 worker01 节点，将静态 Pod 存储路径修改为"),a("code",[s._v("/opt/static-worker01/")]),s._v("。然后在 worker01 上创建一个静态 Pod，要求如下：")])]),s._v(" "),a("ul",[a("li",[s._v("名称为"),a("code",[s._v("pod-static")])]),s._v(" "),a("li",[s._v("命名空间为"),a("code",[s._v("ns1")])]),s._v(" "),a("li",[s._v("设置标签"),a("code",[s._v("run=static")])]),s._v(" "),a("li",[s._v("容器镜像为"),a("code",[s._v("nginx")])]),s._v(" "),a("li",[s._v("镜像下载策略为"),a("code",[s._v("IfNotPresent")])])]),s._v(" "),a("ol",{attrs:{start:"11"}},[a("li",[s._v("列出含有标签"),a("code",[s._v("run=dynamic")]),s._v("的所有 Pod，然后同时删除这些 Pod")]),s._v(" "),a("li",[s._v("删除其余的 Pod")])]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("答案分隔线")]),s._v(" "),a("hr"),s._v(" "),a("h2",{attrs:{id:"实操练习答案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实操练习答案"}},[s._v("#")]),s._v(" 实操练习答案")]),s._v(" "),a("h4",{attrs:{id:"_1-列出命名空间kube-system中的-pod-并查看这些-pod-是运行在哪些节点上的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-列出命名空间kube-system中的-pod-并查看这些-pod-是运行在哪些节点上的"}},[s._v("#")]),s._v(" 1. 列出命名空间"),a("code",[s._v("kube-system")]),s._v("中的 Pod，并查看这些 Pod 是运行在哪些节点上的")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl get pods "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" kube-system "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" wide\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_2-列出所有-pod-的负载信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-列出所有-pod-的负载信息"}},[s._v("#")]),s._v(" 2. 列出所有 Pod 的负载信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v(" pods "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" --sort-by"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("memory\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_3-计算所有命名空间中一共有多少个-pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-计算所有命名空间中一共有多少个-pod"}},[s._v("#")]),s._v(" 3. 计算所有命名空间中一共有多少个 Pod")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl get pods "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-A")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_4-创建命名空间ns1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-创建命名空间ns1"}},[s._v("#")]),s._v(" 4. 创建命名空间"),a("code",[s._v("ns1")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl create ns ns1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_5-通过命令行创建一个pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-通过命令行创建一个pod"}},[s._v("#")]),s._v(" 5. 通过命令行创建一个Pod")]),s._v(" "),a("p",[s._v("Pod 要求：")]),s._v(" "),a("ul",[a("li",[s._v("名称为"),a("code",[s._v("pod1")])]),s._v(" "),a("li",[s._v("容器镜像为"),a("code",[s._v("nginx")])]),s._v(" "),a("li",[s._v("镜像下载策略为"),a("code",[s._v("IfNotPresent")])]),s._v(" "),a("li",[s._v("设置标签"),a("code",[s._v("run=dynamic")])])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl run pod1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--image")]),s._v(" nginx --image-pull-policy"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("IfNotPresent "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dynamic\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_6-创建包含两个容器的-pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-创建包含两个容器的-pod"}},[s._v("#")]),s._v(" 6. 创建包含两个容器的 Pod")]),s._v(" "),a("p",[s._v("Pod 要求：")]),s._v(" "),a("ul",[a("li",[s._v("名称为"),a("code",[s._v("pod2")])]),s._v(" "),a("li",[s._v("设置标签"),a("code",[s._v("run=dynamic")])]),s._v(" "),a("li",[s._v("第一个容器名称为"),a("code",[s._v("c1")]),s._v("，镜像为"),a("code",[s._v("nginx")])]),s._v(" "),a("li",[s._v("第二个容器名称为"),a("code",[s._v("c2")]),s._v("，镜像为"),a("code",[s._v("alpine")]),s._v("，创建该容器时运行命令"),a("code",[s._v('echo "hello alpine" && sleep 999999')])]),s._v(" "),a("li",[s._v("容器的镜像下载策略都为"),a("code",[s._v("IfNotPresent")])])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pod2.yaml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod2\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" dynamic\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" c1\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("imagePullPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" IfNotPresent\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" c2\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" alpine\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("imagePullPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" IfNotPresent\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("command")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sh'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-c'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo \"hello alpine\" && sleep 999999'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl apply "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" pod2.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_7-将pod1的-etc-hosts文件拷贝到物理机的当前目录中"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-将pod1的-etc-hosts文件拷贝到物理机的当前目录中"}},[s._v("#")]),s._v(" 7. 将"),a("code",[s._v("pod1")]),s._v("的"),a("code",[s._v("/etc/hosts")]),s._v("文件拷贝到物理机的当前目录中")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" pod1:/etc/hosts ./hosts\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_8-查看pod2容器c2的日志信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-查看pod2容器c2的日志信息"}},[s._v("#")]),s._v(" 8. 查看"),a("code",[s._v("pod2")]),s._v("容器"),a("code",[s._v("c2")]),s._v("的日志信息")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl logs pod2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" c2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_9-在pod2容器c2中执行命令ifconfig"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-在pod2容器c2中执行命令ifconfig"}},[s._v("#")]),s._v(" 9. 在"),a("code",[s._v("pod2")]),s._v("容器"),a("code",[s._v("c2")]),s._v("中执行命令"),a("code",[s._v("ifconfig")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" pod2 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" c2 -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h4",{attrs:{id:"_10-修改worker01静态pod存储路径-并创建静态pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-修改worker01静态pod存储路径-并创建静态pod"}},[s._v("#")]),s._v(" 10. 修改worker01静态Pod存储路径，并创建静态Pod")]),s._v(" "),a("p",[s._v("手动打开文件修改：")]),s._v(" "),a("ul",[a("li",[s._v("方式一，打开文件"),a("code",[s._v("/usr/lib/systemd/system/kubelet.service.d/10-kubeadm.conf")]),s._v("，在选项"),a("code",[s._v('Environment="..."')]),s._v("后面添加参数"),a("code",[s._v("--pod-manifest-path=<目录>")])]),s._v(" "),a("li",[s._v("方式二，打开文件"),a("code",[s._v("/var/lib/kubelet/config.yaml")]),s._v("，修改参数"),a("code",[s._v("staticPodPath: <目录>")])])]),s._v(" "),a("p",[s._v("通过命令快捷修改：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("sed -i ...")]),s._v("：将更改应用到文件中")]),s._v(" "),a("li",[a("code",[s._v("s/<原始内容>/<替换后的内容>/g")]),s._v("：s 是替换，g 是全局搜索")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过命令快捷修改")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/staticPodPath: .*/staticPodPath: \\/opt\\/static-worker01\\//g'")]),s._v(" /var/lib/kubelet/config.yaml\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改之后, 需要创建对应目录 并 重启服务")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /opt/static-worker01\nsystemctl restart kubelet\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("Pod 要求：")]),s._v(" "),a("ul",[a("li",[s._v("名称为"),a("code",[s._v("pod-static")])]),s._v(" "),a("li",[s._v("命名空间为"),a("code",[s._v("ns1")])]),s._v(" "),a("li",[s._v("设置标签"),a("code",[s._v("run=static")])]),s._v(" "),a("li",[s._v("容器镜像为"),a("code",[s._v("nginx")])]),s._v(" "),a("li",[s._v("镜像下载策略为"),a("code",[s._v("IfNotPresent")])])]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pod-static.yaml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("static\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ns1\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" static\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("imagePullPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" IfNotPresent\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("static\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("p",[s._v("静态 Pod 无需通过 kubectl 创建，只要放到对应的存储目录中即可。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# worker01创建静态Pod")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" ./pod-static.yaml /opt/static-worker01/\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# master查看")]),s._v("\nkubectl get pods "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" ns1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h4",{attrs:{id:"_11-列出含有标签run-dynamic的所有pod-然后同时删除这些-pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-列出含有标签run-dynamic的所有pod-然后同时删除这些-pod"}},[s._v("#")]),s._v(" 11. 列出含有标签"),a("code",[s._v("run=dynamic")]),s._v("的所有Pod，然后同时删除这些 Pod")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("kubectl get pods "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dynamic\nkubectl delete pods "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-l")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("run")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("dynamic "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--force")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"_12-删除其余的-pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-删除其余的-pod"}},[s._v("#")]),s._v(" 12. 删除其余的 Pod")]),s._v(" "),a("p",[s._v("只剩下 worker01 上的一个静态 Pod。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# worker01")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /opt/static-worker01/pod-static.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);