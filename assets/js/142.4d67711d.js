(window.webpackJsonp=window.webpackJsonp||[]).push([[142],{458:function(s,t,e){"use strict";e.r(t);var a=e(7),n=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("div",{staticClass:"cardListContainer"},[t("div",{staticClass:"card-list"},[t("span",{staticClass:"card-item row-2",staticStyle:{"background-color":"#F0DFB1","--randomColor":"#F0DFB1",color:"green"}},[t("div",[t("p",{staticClass:"name"},[s._v("翻译")]),s._v(" "),t("p",{staticClass:"desc"},[s._v("原文：https://devopscube.com/cks-exam-guide-tips/#setup-appropriate-os-level-security-domains-e-g-using-psp-opa-security-contexts")])])])]),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 翻译\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("desc")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 原文：https"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("//devopscube.com/cks"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("exam"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("guide"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("tips/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#setup-appropriate-os-level-security-domains-e-g-using-psp-opa-security-contexts")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("bgColor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#F0DFB1'")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("textColor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'green'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])])]),t("h1",{attrs:{id:"设置适当的操作系统级别安全域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置适当的操作系统级别安全域"}},[s._v("#")]),s._v(" 设置适当的操作系统级别安全域")]),s._v(" "),t("p",[s._v("PSP 已从 "),t("a",{attrs:{href:"https://devopscube.com/kubernetes-v1-21-released/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes v1.21"),t("OutboundLink")],1),s._v(" 中弃用。但从学习的角度来看，这是一个很好的话题。")]),s._v(" "),t("p",[s._v("Open Policy Agent 是一个绝佳的实用程序，用于实现微服务的细粒度控制。")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th"),s._v(" "),t("th")])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("PSP")]),s._v(" "),t("td",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/concepts/policy/pod-security-policy/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Pod Security Policy（Pod安全策略）"),t("OutboundLink")],1)])]),s._v(" "),t("tr",[t("td",[s._v("OPA")]),s._v(" "),t("td",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/blog/2019/08/06/opa-gatekeeper-policy-and-governance-for-kubernetes/",target:"_blank",rel:"noopener noreferrer"}},[s._v("OPA Gatekeeper：Kubernetes 的策略和管理"),t("OutboundLink")],1)])]),s._v(" "),t("tr",[t("td",[s._v("安全上下文任务")]),s._v(" "),t("td",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/security-context/",target:"_blank",rel:"noopener noreferrer"}},[s._v("为 Pod 或容器配置安全上下文"),t("OutboundLink")],1)])])])]),s._v(" "),t("div",{staticClass:"custom-block note"},[t("p",{staticClass:"custom-block-title"},[s._v("译者加")]),s._v(" "),t("p",[s._v("我还找到了一些相关的链接：")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/blog/2021/04/06/podsecuritypolicy-deprecation-past-present-and-future/",target:"_blank",rel:"noopener noreferrer"}},[s._v("弃用 PodSecurityPolicy：过去、现在、未来"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/concepts/security/pod-security-standards/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Pod 安全性标准"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/concepts/security/pod-security-admission/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Pod 安全性准入"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/enforce-standards-admission-controller/",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置准入控制器实施 Pod 安全标准"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/tasks/configure-pod-container/enforce-standards-namespace-labels/",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用命名空间标签来实施 Pod 安全性标准"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://github.com/open-policy-agent/gatekeeper",target:"_blank",rel:"noopener noreferrer"}},[s._v("Gatekeeper 项目地址"),t("OutboundLink")],1)])]),s._v(" "),t("p",[s._v("配置准入控制器实施 Pod 安全性标准：")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" apiserver.config.k8s.io/v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" AdmissionConfiguration\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("plugins")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" PodSecurity\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("configuration")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("security.admission.config.k8s.io/v1\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" PodSecurityConfiguration\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("defaults")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 策略 privileged、baseline、restricted")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# 版本 latest（默认）、或者诸如 "v1.28" 这类版本号')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enforce")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"privileged"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("enforce-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"latest"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("audit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"privileged"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("audit-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"latest"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("warn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"privileged"')]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("warn-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"latest"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("exemptions")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要豁免的已认证用户名列表")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("usernames")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要豁免的运行时类名称列表")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("runtimeClasses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要豁免的名字空间列表")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespaces")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("p",[s._v("通过命名空间标签实施 Pod 安全性标准：")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Namespace\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("...")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将 baseline 和 restricted 策略的版本锁定到 v1.28")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 阻止任何不满足 baseline 策略要求的 Pod")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pod-security.kubernetes.io/enforce")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" baseline\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pod-security.kubernetes.io/enforce-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1.28\n\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 针对任何无法满足 restricted 策略要求的、已创建的 Pod 为用户生成警告信息，并添加审计注解")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pod-security.kubernetes.io/audit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" restricted\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pod-security.kubernetes.io/audit-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1.28\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pod-security.kubernetes.io/warn")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" restricted\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pod-security.kubernetes.io/warn-version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1.28\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);